<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<%@ taglib prefix="ui" uri="http://egovframework.gov/ctl/ui" %>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags" %>

<jsp:include page="/Component/module/header.jsp" flush="true"/>
<jsp:include page="/Component/module/menu.jsp" flush="true"/>
<style>
    h2{
        Display: Inline;
    }
    #calendarDiv td{
        width:100px;
        height:100px;
        /* border: solid black 1px; */
    }
</style>

<script type="text/javaScript">

    var toDate = new Date();
    /* var toYear = toDate.getFullYear();
     var toMonth = toDate.getMonth(); */
    var toDay = toDate.getDate();

    var toYear = <c:out value="${NowYear}"/>
    var toMonth = <c:out value="${NowMonth}"/>


            $(document).ready(function(){
                <!--년 월을 넣어 달력 제작 -->
                showCalendar(toYear , toMonth);
            });

    <!--음력 달력에 넣기-->

    function fnHoliLunarSet2(y,m){

    <c:forEach var="rs" items="${holiDayList}" varStatus="status">

        if(Number(m)===Number('${rs.month}')){

            if(${status.index}===0){
                $('.'+'${rs.day}').html('${rs.day}'+' <br><span class="colorPoint">구정</span>');
                $('.colorPoint').css('color','#0000FF');
            }
            if(${status.index}===3){
                $('.'+'${rs.day}').html('${rs.day}'+' <br><span class="colorPoint">부처님 오신날</span>');
                $('.colorPoint').css('color','#0000FF');
            }
            if(${status.index}===4){
                $('.'+'${rs.day}').html('${rs.day}'+' <br><span class="colorPoint">추석</span>');
                $('.colorPoint').css('color','#0000FF');
            }
            $('.'+'${rs.day}').css('color','#41A541');
        }

    </c:forEach>
    }



    <!--오늘 날짜 -->
    function fnSet(){
        $('.'+Number(toDay)).css('color', 'red');
    }

    <!-- 켈린더 제작 -->
    function showCalendar(y, m) {


        var text = '<div style="text-align:center">';
        text += '<span onclick="showCalendar('+(y-1)+','+m+')"><input type="button" value="<<"> </span>';
        text += '<span onclick="showCalendar('+(m==1? (y-1)+','+12:y+','+(m-1))+')"><input type="button" value="<="></span>';
        text += '<h2> [' + y + '/' + ((m<10) ? ('0' + m) : m ) + '] </h2>';
        text += '<span onclick="showCalendar('+(m==12? (y+1)+ ','+1: y+","+(m+1))+')"><input type="button" value="=>"></span>';
        text += '<span onclick="showCalendar('+(y+1)+','+m+')"><input type="button" value=">>"></span>';
        text += '</div>\n';

        text += '<table>\n<thead>\n';
        text += '<th scope="col">일</th>\n';
        text += '<th scope="col">월</th>\n';
        text += '<th scope="col">화</th>\n';
        text += '<th scope="col">수</th>\n';
        text += '<th scope="col">목</th>\n';
        text += '<th scope="col">금</th>\n';
        text += '<th scope="col">토</th>\n';
        text += '</thead>\n<tbody>\n<tr>';


        var d1 = (y+(y-y%4)/4-(y-y%100)/100+(y-y%400)/400
                +m*2+(m*5-m*5%9)/9-(m<3?y%4||y%100==0&&y%400?2:3:4))%7;
        for (var i = 0; i < 42; i++){
            if (i%7==0) text += '</tr>\n<tr>';

            if (i < d1 || i >= d1+(m*9-m*9%8)/8%2+(m==2?y%4||y%100==0&&y%400?28:29:30)){
                text += '<td> </td>';
            }
            else{
                text += '<td' + (i%7 ? '' : ' style="color:red;"') +' class="'+ (i+1-d1) + '">' + (i+1-d1) + '</td>';
            }
        }
        document.getElementById('calendarDiv').innerHTML = text + '</tr>\n</tbody></table>';

        //현재 년, 월과 일치시
        if(toYear === Number(y) && toMonth === Number(m)){
            fnSet();
        }

        fnHoliLunarSet2(y,m);
        fnHoliSunSet(y,m);
    }

    <!--양력 공휴일 추가소스들: 공휴일 정보를 담을 함수 생성 -->
    function holiDaysSunList(sunMonth,sunDay,sunName,solarLunar){
        this.sunMonth = sunMonth;
        this.sunDay = sunDay;
        this.sunName = sunName;
        this.solarLunar = solarLunar;
    }
    <!-- 공휴일 리스트 배열 작성 -->
    var holiDaysSunLists = [new holiDaysSunList(1,1,"신정",1),
        new holiDaysSunList(3,1,"3.1절",1),
        new holiDaysSunList(5,5,"어린이날",1),
        new holiDaysSunList(8,15,"광복절",1),
        new holiDaysSunList(10,3,"개천절",1),
        new holiDaysSunList(10,9,"한글날",1),
        new holiDaysSunList(12,25,"크리스마스",1)];
    <!-- 공휴일 리스트 배열을 달력에 삽입 -->
    function fnHoliSunSet(y,m){
        for(var i = 0; i < holiDaysSunLists.length; i++){
            if (Number(m) === holiDaysSunLists[i].sunMonth) {
                $('.' + holiDaysSunLists[i].sunDay).html(holiDaysSunLists[i].sunDay
                        + '<br><span class="colorPoint">'+holiDaysSunLists[i].sunName+'</span>');
                $('.' + holiDaysSunLists[i].sunDay).css('color', '#C12DFF');
                $('.colorPoint').css('color', '#0000FF');
            }
        }
    }
</script>

<article class="ui-board ui-list">
    <form:form commandName="searchVO" name="form" method="post" action="/Request.do">
        <input type="hidden" name="execute" id="execute" value="<c:out value='${searchVO.execute}'/>" title="상세실행구분"/>
        <input type="hidden" name="TOKEN_KEY" id="TOKEN_KEY" value="<c:out value='${TOKEN_KEY}'/>" title="실행중복확인키"/>
        <form:hidden path="command" title="실행구분"/>
        <input type="hidden" name="execute" id="execute" value="<c:out value='${searchVO.execute}'/>" title="상세실행구분"/>
        <form:hidden path="pageid" title="페이지아이디"/>
        <form:hidden path="scheYear" title="검색년도"/>
        <form:hidden path="scheMonth" title="검색달"/>
        <form:hidden path="searchIdx" title="검색일련번호"/>

        <div id="calendarDiv" style="text-align:center">

        </div>

    </form:form>
</article>

<jsp:include page="/Component/module/footer.jsp" flush="true"/>